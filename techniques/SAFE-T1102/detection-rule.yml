title: MCP Prompt Injection Detection
id: 42b14c6d-f436-40c7-86fa-b00d5350aef0
status: experimental
description: Detects suspicious injection patterns in tool outputs
author: Frederick Kautz
date: 2025-07-15
references:
  - https://github.com/safe-mcp/techniques/SAFE-T1102
  - https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/
  - https://arxiv.org/abs/2310.12815
logsource:
  product: mcp
  service: tool_output
detection:
  selection_system_instructions:
    tool_output:
      - '*SYSTEM:*'
      - '*[SYSTEM]*'
      - '*<SYSTEM>*'
      - '*[INST]*'
      - '*[/INST]*'
      - '*<|system|>*'
      - '*<|assistant|>*'
  selection_override_commands:
    tool_output:
      - '*Ignore previous*'
      - '*Disregard prior*'
      - '*Forget everything*'
      - '*New instructions:*'
      - '*OVERRIDE:*'
      - '*</data>*'
      - '*</end>*'
  selection_delimiter_bypass:
    tool_output:
      - '*\u0000*'  # Null byte
      - '*\u200B*'  # Zero-width space
      - '*\uFEFF*'  # Zero-width no-break space
      - '*%00*'     # URL encoded null
      - '*%0A*'     # URL encoded newline
  selection_recursive_patterns:
    tool_output:
      - '*call tool*'
      - '*invoke function*'
      - '*execute command*'
      - '*run script*'
  selection_exfiltration:
    tool_output:
      - '*curl*http*'
      - '*wget*http*'
      - '*POST*attacker*'
      - '*send to*http*'
      - '*exfiltrate*'
  timeframe: 10m
  condition: selection_system_instructions or selection_override_commands or selection_delimiter_bypass or selection_recursive_patterns or selection_exfiltration
fields:
  - timestamp
  - tool_name
  - tool_output
  - user_id
  - session_id
  - source_ip
falsepositives:
  - Legitimate instructional content in educational tools
  - Code documentation containing example prompts
  - Security testing outputs
level: high
tags:
  - attack.execution
  - attack.t1059
  - attack.t1055
  - safe.t1102
  - prompt_injection
  - mcp