# NGINX minimal example (tune sizes/rates!)
# http { ... }
limit_req_zone $binary_remote_addr zone=per_ip:10m rate=2r/s;        # ~120/min
limit_req_zone $http_x_client_id   zone=per_client:10m rate=1r/s;    # 60/min
map $request_uri $tool_bucket { default per_tool_default; }
limit_req_zone $tool_bucket zone=per_tool:10m rate=1r/s;             # 60/min

server {
  location /tools/ {
    limit_req zone=per_ip    burst=60 nodelay;
    limit_req zone=per_tool  burst=20 nodelay;
    limit_req zone=per_client burst=20 nodelay;
    proxy_pass http://tool-backend;
  }
}
